#Mary Rose G.Liguan
#BS in Statistics-3
#CMSC197-3
#SecondMiniProjectIn
#Explaination of the code in run_analysis.R

##After downloading  the zipped file UCI_HAR_Dataset.zip from the LMS, Unzipping the file and creating a directory 'specdata' in a local file Change the working directory using setwd() function  by using the specific path where the downloaded and unzipped file is located in your local computer.  
setwd("C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset")

##List all the files in the working directory by using list.files() function and assign it to a variable named files
files<-list.files("C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset", recursive=T, full.names=T, all.files=T)
##Checking the list of files assigned to a variable named files
files
### [1] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/activity_labels.txt"                         
### [2] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/features.txt"                                
### [3] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/features_info.txt"                           
### [4] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/README.txt"                                  
### [5] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/test/Inertial Signals/body_acc_x_test.txt"   
###[6] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/test/Inertial Signals/body_acc_y_test.txt"
###[7] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/test/Inertial Signals/body_acc_z_test.txt"
###[8] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/test/Inertial Signals/body_gyro_x_test.txt"  
###[9] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/test/Inertial Signals/body_gyro_y_test.txt"  
###[10] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/test/Inertial Signals/body_gyro_z_test.txt"  
###[11] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/test/Inertial Signals/total_acc_x_test.txt"  
###[12] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/test/Inertial Signals/total_acc_y_test.txt"  
###[13] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/test/Inertial Signals/total_acc_z_test.txt"  
###[14] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/test/subject_test.txt"                       
###[15] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/test/X_test.txt"                             
###[16] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/test/y_test.txt"                             
###[17] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/train/Inertial Signals/body_acc_x_train.txt" 
###[18] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/train/Inertial Signals/body_acc_y_train.txt" 
###[19] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/train/Inertial Signals/body_acc_z_train.txt" 
###[20] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/train/Inertial Signals/body_gyro_x_train.txt"
###[21] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/train/Inertial Signals/body_gyro_y_train.txt"
###[22] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/train/Inertial Signals/body_gyro_z_train.txt"
###[23] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/train/Inertial Signals/total_acc_x_train.txt"
###[24] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/train/Inertial Signals/total_acc_y_train.txt"
###[25] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/train/Inertial Signals/total_acc_z_train.txt"
###[26] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/train/subject_train.txt"                     
###[27] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/train/X_train.txt"                           
###[28] "C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset/train/y_train.txt" 

##Reading the needed files in table format and creating a data frame from it using read.table() and assign it to a variable.

##Reading the text file "Y_test" from "test" folder using read.table() and assign it to a variable named testActivityData.
testActivityData  <- read.table(file.path("C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset", "test" , "Y_test.txt" ),header = FALSE)
##Check the property of testActivityData using str() function
str(testActivityData)
### 'data.frame':	2947 obs. of  1 variable:
### $ V1: int  5 5 5 5 5 5 5 5 5 5 ...

##Reading the text file "Y_train" from "test" folder using read.table() and assign it to a variable named trainActivityData.
trainActivityData<- read.table(file.path("C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset", "train", "Y_train.txt"),header = FALSE)
##Check the property of trainActivityData using str() function
str(trainActivityData)
### 'data.frame':	7352 obs. of  1 variable:
### $ V1: int  5 5 5 5 5 5 5 5 5 5 ...

#Reading the text file "subject_test" from "test" folder using read.table() and assign it to a variable named testSubjectData.
testSubjectData  <- read.table(file.path("C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset", "test" , "subject_test.txt"),header = FALSE)
##Check the property of dataSubjectTest using str() function
str(testSubjectData)
###'data.frame':	2947 obs. of  1 variable:
### $ V1: int  2 2 2 2 2 2 2 2 2 2 ...

##Reading the text file "subject_train" from "test" folder using read.table() and assign it to a variable named trainSubjectData.
trainSubjectData <- read.table(file.path("C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset", "train", "subject_train.txt"),header = FALSE)
##Check the property of dataSubjectTrain using str() function
str(trainSubjectData)
###'data.frame':	7352 obs. of  1 variable:
### $ V1: int  1 1 1 1 1 1 1 1 1 1 ...

##Reading the text file "X_test" from "test" folder using read.table() and assign it to a variable named testFeaturesData.
testFeaturesData  <- read.table(file.path("C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset", "test" , "X_test.txt" ),header = FALSE)
##Check the property of dataFeaturesTest using str() function
str(testFeaturesData)
###'data.frame':	2947 obs. of  561 variables:
### $ V1  : num  0.257 0.286 0.275 0.27 0.275 ...
### $ V2  : num  -0.0233 -0.0132 -0.0261 -0.0326 -0.0278 ...
### $ V3  : num  -0.0147 -0.1191 -0.1182 -0.1175 -0.1295 ...
### $ V4  : num  -0.938 -0.975 -0.994 -0.995 -0.994 ...
### $ V5  : num  -0.92 -0.967 -0.97 -0.973 -0.967 ...
### . .   . .     .      .     .      .      .    ...
### . .   . .     .      .     .      .      .    ...
### . .   . .     .      .     .      .      .    ...
### $ V97 : num  -0.995 -0.998 -1 -1 -1 ...
### $ V98 : num  -0.997 -0.999 -0.999 -0.999 -1 ...
### $ V99 : num  -0.997 -0.999 -0.999 -0.999 -1 ...
###  [list output truncated]

##Reading the text file "X_train" from "test" folder using read.table() and assign it to a variable named trainFeaturesData.
trainFeaturesData <- read.table(file.path("C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset", "train", "X_train.txt"),header = FALSE)
##Check the property ofdataFeaturesTrain using str() function
str(trainFeaturesData)
###'data.frame':	7352 obs. of  561 variables:
### $ V1  : num  0.289 0.278 0.28 0.279 0.277 ...
### $ V2  : num  -0.0203 -0.0164 -0.0195 -0.0262 -0.0166 ...
### $ V3  : num  -0.133 -0.124 -0.113 -0.123 -0.115 ...
### $ V4  : num  -0.995 -0.998 -0.995 -0.996 -0.998 ...
### $ V5  : num  -0.983 -0.975 -0.967 -0.983 -0.981 ...
### . .   . .     .      .     .      .      .    ...
### . .   . .     .      .     .      .      .    ...
### . .   . .     .      .     .      .      .    ...
### $ V94 : num  0.992 0.992 0.992 0.993 0.993 ...
### $ V95 : num  0.991 0.989 0.989 0.993 0.986 ...
### $ V96 : num  -0.994 -0.991 -0.988 -0.993 -0.994 ...
### $ V97 : num  -1 -1 -1 -1 -1 ...
### $ V98 : num  -1 -1 -1 -1 -1 ...
### $ V99 : num  -1 -1 -1 -1 -1 ...
###  [list output truncated]

##Concatenate strings of test and train data  using rbind() function and assign it to a variable 

##Concatenate testActivityData and trainActivityData and assign it to a variable named ActivityData
Activity<- rbind(testActivityData, trainActivityData)
##Check the head of Activity
head(Activity)
###   V1
### 1  5
### 2  5
### 3  5
### 4  5
### 5  5
### 6  5

##Concatenate testSubjectData and trainSubjectData and assign it to a variable named SubjectData
Subject <- rbind(testSubjectData, trainSubjectData)
##Check the head of Subject
head(Subject)
###  V1
### 1  2
### 2  2
### 3  2
### 4  2
### 5  2
### 6  2

##Concatenate testFeaturesData and trainFeaturesData and assign it to a variable named ActivityData
Features<- rbind(testFeaturesData, trainFeaturesData)
##Check the property of Features using str() function
str(Features)
### 'data.frame':	10299 obs. of  561 variables:
### $ V1  : num  0.257 0.286 0.275 0.27 0.275 ...
### $ V2  : num  -0.0233 -0.0132 -0.0261 -0.0326 -0.0278 ...
### $ V3  : num  -0.0147 -0.1191 -0.1182 -0.1175 -0.1295 ...
### $ V4  : num  -0.938 -0.975 -0.994 -0.995 -0.994 ...
### $ V5  : num  -0.92 -0.967 -0.97 -0.973 -0.967 ...
### . .   . .     .     .      .     .      .    ...
### . .   . .     .     .      .     .      .    ...
### . .   . .     .     .      .     .      .    ...
### $ V95 : num  0.946 0.966 0.966 0.97 0.985 ...
### $ V96 : num  -0.931 -0.974 -0.982 -0.983 -0.987 ...
### $ V97 : num  -0.995 -0.998 -1 -1 -1 ...
### $ V98 : num  -0.997 -0.999 -0.999 -0.999 -1 ...
### $ V99 : num  -0.997 -0.999 -0.999 -0.999 -1 ...
###  [list output truncated]

##Read the text file "features" from "UCI HAR Dataset" folder using read.table() and assign it to a variable named readFeaturesData.
readFeaturesData <- read.table(file.path("C:/Users/ASUS/Desktop/specdata/UCI HAR Dataset", "features.txt"),head=FALSE)

##Setting the name of Activity object as "Subject" 
names(Activity)<- c("Activity")
##Check the head of Activity
head(Activity)
###  Activity
### 1        5
### 2        5
### 3        5
### 4        5
### 5        5
### 6        5

##Setting the name of Subject object as "Subject" 
names(Subject)<-c("Subject")
##Check the head of Subject
head(Subject)
### Subject
### 1       2
### 2       2
### 3       2
### 4       2
### 5       2
### 6       2

##Getting the name of Features from the column2 of readFeaturesData
names(Features)<- readFeaturesData$V2
##Check the property of readFeaturesData$V2 using str() function
str(Features)
### 'data.frame':	10299 obs. of  561 variables:
### $ tBodyAcc-mean()-X                   : num  0.257 0.286 0.275 0.27 0.275 ...
### $ tBodyAcc-mean()-Y                   : num  -0.0233 -0.0132 -0.0261 -0.0326 -0.0278 ...
### $ tBodyAcc-mean()-Z                   : num  -0.0147 -0.1191 -0.1182 -0.1175 -0.1295 ...
### $ tBodyAcc-std()-X                    : num  -0.938 -0.975 -0.994 -0.995 -0.994 ...
### $ tBodyAcc-std()-Y                    : num  -0.92 -0.967 -0.97 -0.973 -0.967 ...
### $ tBodyAcc-std()-Z                    : num  -0.668 -0.945 -0.963 -0.967 -0.978 ...
### $ tBodyAcc-mad()-X                    : num  -0.953 -0.987 -0.994 -0.995 -0.994 ...
### $ tBodyAcc-mad()-Y                    : num  -0.925 -0.968 -0.971 -0.974 -0.966 ...
### $ tBodyAcc-mad()-Z                    : num  -0.674 -0.946 -0.963 -0.969 -0.977 ...
### $ tBodyAcc-max()-X                    : num  -0.894 -0.894 -0.939 -0.939 -0.939 ...
### $ tBodyAcc-max()-Y                    : num  -0.555 -0.555 -0.569 -0.569 -0.561 ...
### $ tBodyAcc-max()-Z                    : num  -0.466 -0.806 -0.799 -0.799 -0.826 ...
### $ tBodyAcc-min()-X                    : num  0.717 0.768 0.848 0.848 0.849 ...
### $ tBodyAcc-min()-Y                    : num  0.636 0.684 0.668 0.668 0.671 ...
### $ tBodyAcc-min()-Z                    : num  0.789 0.797 0.822 0.822 0.83 ...
### $ tBodyAcc-sma()                      : num  -0.878 -0.969 -0.977 -0.974 -0.975 ...
### $ tBodyAcc-energy()-X                 : num  -0.998 -1 -1 -1 -1 ...
### $ tBodyAcc-energy()-Y                 : num  -0.998 -1 -1 -0.999 -0.999 ...
### $ tBodyAcc-energy()-Z                 : num  -0.934 -0.998 -0.999 -0.999 -0.999 ...
### $ tBodyAcc-iqr()-X                    : num  -0.976 -0.994 -0.993 -0.995 -0.993 ...
### $ tBodyAcc-iqr()-Y                    : num  -0.95 -0.974 -0.974 -0.979 -0.967 ...
### $ tBodyAcc-iqr()-Z                    : num  -0.83 -0.951 -0.965 -0.97 -0.976 ...
### $ tBodyAcc-entropy()-X                : num  -0.168 -0.302 -0.618 -0.75 -0.591 ...
### $ tBodyAcc-entropy()-Y                : num  -0.379 -0.348 -0.695 -0.899 -0.74 ...
### $ tBodyAcc-entropy()-Z                : num  0.246 -0.405 -0.537 -0.554 -0.799 ...
### $ tBodyAcc-arCoeff()-X,1              : num  0.521 0.507 0.242 0.175 0.116 ...
### $ tBodyAcc-arCoeff()-X,2              : num  -0.4878 -0.1565 -0.115 -0.0513 -0.0289 ...
### $ tBodyAcc-arCoeff()-X,3              : num  0.4823 0.0407 0.0327 0.0342 -0.0328 ...
### $ tBodyAcc-arCoeff()-X,4              : num  -0.0455 0.273 0.1924 0.1536 0.2943 ...
### $ tBodyAcc-arCoeff()-Y,1              : num  0.21196 0.19757 -0.01194 0.03077 0.00063 ...
### $ tBodyAcc-arCoeff()-Y,2              : num  -0.1349 -0.1946 -0.0634 -0.1293 -0.0453 ...
### $ tBodyAcc-arCoeff()-Y,3              : num  0.131 0.411 0.471 0.446 0.168 ...
### $ tBodyAcc-arCoeff()-Y,4              : num  -0.0142 -0.3405 -0.5074 -0.4195 -0.0682 ...
### $ tBodyAcc-arCoeff()-Z,1              : num  -0.106 0.0776 0.1885 0.2715 0.0744 ...
### $ tBodyAcc-arCoeff()-Z,2              : num  0.0735 -0.084 -0.2316 -0.2258 0.0271 ...
### $ tBodyAcc-arCoeff()-Z,3              : num  -0.1715 0.0353 0.6321 0.4164 -0.1459 ...
### $ tBodyAcc-arCoeff()-Z,4              : num  0.0401 -0.0101 -0.5507 -0.2864 -0.0502 ...
### $ tBodyAcc-correlation()-X,Y          : num  0.077 -0.105 0.3057 -0.0638 0.2352 ...
### $ tBodyAcc-correlation()-X,Z          : num  -0.491 -0.429 -0.324 -0.167 0.29 ...
### $ tBodyAcc-correlation()-Y,Z          : num  -0.709 0.399 0.28 0.545 0.458 ...
### $ tGravityAcc-mean()-X                : num  0.936 0.927 0.93 0.929 0.927 ...
### $ tGravityAcc-mean()-Y                : num  -0.283 -0.289 -0.288 -0.293 -0.303 ...
### $ tGravityAcc-mean()-Z                : num  0.115 0.153 0.146 0.143 0.138 ...
### $ tGravityAcc-std()-X                 : num  -0.925 -0.989 -0.996 -0.993 -0.996 ...
### $ tGravityAcc-std()-Y                 : num  -0.937 -0.984 -0.988 -0.97 -0.971 ...
### $ tGravityAcc-std()-Z                 : num  -0.564 -0.965 -0.982 -0.992 -0.968 ...
### $ tGravityAcc-mad()-X                 : num  -0.93 -0.989 -0.996 -0.993 -0.996 ...
### $ tGravityAcc-mad()-Y                 : num  -0.938 -0.983 -0.989 -0.971 -0.971 ...
### $ tGravityAcc-mad()-Z                 : num  -0.606 -0.965 -0.98 -0.993 -0.969 ...
### $ tGravityAcc-max()-X                 : num  0.906 0.856 0.856 0.856 0.854 ...
### $ tGravityAcc-max()-Y                 : num  -0.279 -0.305 -0.305 -0.305 -0.313 ...
### $ tGravityAcc-max()-Z                 : num  0.153 0.153 0.139 0.136 0.134 ...
### $ tGravityAcc-min()-X                 : num  0.944 0.944 0.949 0.947 0.946 ...
### $ tGravityAcc-min()-Y                 : num  -0.262 -0.262 -0.262 -0.273 -0.279 ...
### $ tGravityAcc-min()-Z                 : num  -0.0762 0.149 0.145 0.1421 0.1309 ...
### $ tGravityAcc-sma()                   : num  -0.0178 0.0577 0.0406 0.0461 0.0554 ...
### $ tGravityAcc-energy()-X              : num  0.829 0.806 0.812 0.809 0.804 ...
### $ tGravityAcc-energy()-Y              : num  -0.865 -0.858 -0.86 -0.854 -0.843 ...
### $ tGravityAcc-energy()-Z              : num  -0.968 -0.957 -0.961 -0.963 -0.965 ...
### $ tGravityAcc-iqr()-X                 : num  -0.95 -0.988 -0.996 -0.992 -0.996 ...
### $ tGravityAcc-iqr()-Y                 : num  -0.946 -0.982 -0.99 -0.973 -0.972 ...
### $ tGravityAcc-iqr()-Z                 : num  -0.76 -0.971 -0.979 -0.996 -0.969 ...
### $ tGravityAcc-entropy()-X             : num  -0.425 -0.729 -0.823 -0.823 -0.83 ...
### $ tGravityAcc-entropy()-Y             : num  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...
### $ tGravityAcc-entropy()-Z             : num  0.219 -0.465 -0.53 -0.7 -0.302 ...
### $ tGravityAcc-arCoeff()-X,1           : num  -0.43 -0.51 -0.295 -0.343 -0.482 ...
### $ tGravityAcc-arCoeff()-X,2           : num  0.431 0.525 0.305 0.359 0.539 ...
### $ tGravityAcc-arCoeff()-X,3           : num  -0.432 -0.54 -0.315 -0.375 -0.596 ...
### $ tGravityAcc-arCoeff()-X,4           : num  0.433 0.554 0.326 0.392 0.655 ...
### $ tGravityAcc-arCoeff()-Y,2           : num  0.781 0.733 0.169 0.176 0.463 ...
### $ tGravityAcc-arCoeff()-Y,3           : num  -0.78 -0.737 -0.155 -0.169 -0.465 ...
### $ tGravityAcc-arCoeff()-Y,4           : num  0.785 0.749 0.164 0.185 0.483 ...
### $ tGravityAcc-arCoeff()-Z,1           : num  -0.984 -0.845 -0.429 -0.297 -0.536 ...
### $ tGravityAcc-arCoeff()-Z,2           : num  0.987 0.869 0.44 0.304 0.544 ...
### $ tGravityAcc-arCoeff()-Z,3           : num  -0.989 -0.893 -0.451 -0.311 -0.553 ...
### $ tGravityAcc-arCoeff()-Z,4           : num  0.988 0.913 0.458 0.315 0.559 ...
### $ tGravityAcc-correlation()-X,Y       : num  0.981 0.945 0.548 0.986 0.998 ...
### $ tGravityAcc-correlation()-X,Z       : num  -0.996 -0.911 -0.335 0.653 0.916 ...
### $ tGravityAcc-correlation()-Y,Z       : num  -0.96 -0.739 0.59 0.747 0.929 ...
### $ tBodyAccJerk-mean()-X               : num  0.072 0.0702 0.0694 0.0749 0.0784 ...
### $ tBodyAccJerk-mean()-Y               : num  0.04575 -0.01788 -0.00491 0.03227 0.02228 ...
### $ tBodyAccJerk-mean()-Z               : num  -0.10604 -0.00172 -0.01367 0.01214 0.00275 ...
### $ tBodyAccJerk-std()-X                : num  -0.907 -0.949 -0.991 -0.991 -0.992 ...
### $ tBodyAccJerk-std()-Y                : num  -0.938 -0.973 -0.971 -0.973 -0.979 ...
### $ tBodyAccJerk-std()-Z                : num  -0.936 -0.978 -0.973 -0.976 -0.987 ...
### $ tBodyAccJerk-mad()-X                : num  -0.916 -0.969 -0.991 -0.99 -0.991 ...
### $ tBodyAccJerk-mad()-Y                : num  -0.937 -0.974 -0.973 -0.973 -0.977 ...
### $ tBodyAccJerk-mad()-Z                : num  -0.949 -0.979 -0.975 -0.978 -0.985 ...
### $ tBodyAccJerk-max()-X                : num  -0.903 -0.915 -0.992 -0.992 -0.994 ...
### $ tBodyAccJerk-max()-Y                : num  -0.95 -0.981 -0.975 -0.975 -0.986 ...
### $ tBodyAccJerk-max()-Z                : num  -0.891 -0.978 -0.962 -0.962 -0.986 ...
### $ tBodyAccJerk-min()-X                : num  0.898 0.898 0.994 0.994 0.994 ...
### $ tBodyAccJerk-min()-Y                : num  0.95 0.968 0.976 0.976 0.98 ...
### $ tBodyAccJerk-min()-Z                : num  0.946 0.966 0.966 0.97 0.985 ...
### $ tBodyAccJerk-sma()                  : num  -0.931 -0.974 -0.982 -0.983 -0.987 ...
### $ tBodyAccJerk-energy()-X             : num  -0.995 -0.998 -1 -1 -1 ...
### $ tBodyAccJerk-energy()-Y             : num  -0.997 -0.999 -0.999 -0.999 -1 ...
### $ tBodyAccJerk-energy()-Z             : num  -0.997 -0.999 -0.999 -0.999 -1 ...
###  [list output truncated]

##Merging columns to produce a dataframe MergedData

##Merging first the SubjectData and ActivityData and assigned it to a variable named SubActMergedData using cbind() function
SubActMergedData <- cbind(Subject, Activity)

##Merging FeaturesData and SubActMergedData and assign it to a variable named MergedData
MergedData <- cbind(Features, SubActMergedData)
##Check the property of MergedData using str() function
str(MergedData)
### 'data.frame':	10299 obs. of  563 variables:
### $ tBodyAcc-mean()-X                   : num  0.257 0.286 0.275 0.27 0.275 ...
### $ tBodyAcc-mean()-Y                   : num  -0.0233 -0.0132 -0.0261 -0.0326 -0.0278 ...
### $ tBodyAcc-mean()-Z                   : num  -0.0147 -0.1191 -0.1182 -0.1175 -0.1295 ...
### $ tBodyAcc-std()-X                    : num  -0.938 -0.975 -0.994 -0.995 -0.994 ...
### $ tBodyAcc-std()-Y                    : num  -0.92 -0.967 -0.97 -0.973 -0.967 ...
### $ tBodyAcc-std()-Z                    : num  -0.668 -0.945 -0.963 -0.967 -0.978 ...
### $ tBodyAcc-mad()-X                    : num  -0.953 -0.987 -0.994 -0.995 -0.994 ...
### $ tBodyAcc-mad()-Y                    : num  -0.925 -0.968 -0.971 -0.974 -0.966 ...
### $ tBodyAcc-mad()-Z                    : num  -0.674 -0.946 -0.963 -0.969 -0.977 ...
### $ tBodyAcc-max()-X                    : num  -0.894 -0.894 -0.939 -0.939 -0.939 ...
### $ tBodyAcc-max()-Y                    : num  -0.555 -0.555 -0.569 -0.569 -0.561 ...
### $ tBodyAcc-max()-Z                    : num  -0.466 -0.806 -0.799 -0.799 -0.826 ...
### $ tBodyAcc-min()-X                    : num  0.717 0.768 0.848 0.848 0.849 ...
### $ tBodyAcc-min()-Y                    : num  0.636 0.684 0.668 0.668 0.671 ...
### $ tBodyAcc-min()-Z                    : num  0.789 0.797 0.822 0.822 0.83 ...
### $ tBodyAcc-sma()                      : num  -0.878 -0.969 -0.977 -0.974 -0.975 ...
### $ tBodyAcc-energy()-X                 : num  -0.998 -1 -1 -1 -1 ...
### $ tBodyAcc-energy()-Y                 : num  -0.998 -1 -1 -0.999 -0.999 ...
### $ tBodyAcc-energy()-Z                 : num  -0.934 -0.998 -0.999 -0.999 -0.999 ...
### $ tBodyAcc-iqr()-X                    : num  -0.976 -0.994 -0.993 -0.995 -0.993 ...
### $ tBodyAcc-iqr()-Y                    : num  -0.95 -0.974 -0.974 -0.979 -0.967 ...
### $ tBodyAcc-iqr()-Z                    : num  -0.83 -0.951 -0.965 -0.97 -0.976 ...
### $ tBodyAcc-entropy()-X                : num  -0.168 -0.302 -0.618 -0.75 -0.591 ...
### $ tBodyAcc-entropy()-Y                : num  -0.379 -0.348 -0.695 -0.899 -0.74 ...
### $ tBodyAcc-entropy()-Z                : num  0.246 -0.405 -0.537 -0.554 -0.799 ...
### $ tBodyAcc-arCoeff()-X,1              : num  0.521 0.507 0.242 0.175 0.116 ...
### $ tBodyAcc-arCoeff()-X,2              : num  -0.4878 -0.1565 -0.115 -0.0513 -0.0289 ...
### $ tBodyAcc-arCoeff()-X,3              : num  0.4823 0.0407 0.0327 0.0342 -0.0328 ...
### $ tBodyAcc-arCoeff()-X,4              : num  -0.0455 0.273 0.1924 0.1536 0.2943 ...
### $ tBodyAcc-arCoeff()-Y,1              : num  0.21196 0.19757 -0.01194 0.03077 0.00063 ...
### $ tBodyAcc-arCoeff()-Y,2              : num  -0.1349 -0.1946 -0.0634 -0.1293 -0.0453 ...
### $ tBodyAcc-arCoeff()-Y,3              : num  0.131 0.411 0.471 0.446 0.168 ...
### $ tBodyAcc-arCoeff()-Y,4              : num  -0.0142 -0.3405 -0.5074 -0.4195 -0.0682 ...
### $ tBodyAcc-arCoeff()-Z,1              : num  -0.106 0.0776 0.1885 0.2715 0.0744 ...
### $ tBodyAcc-arCoeff()-Z,2              : num  0.0735 -0.084 -0.2316 -0.2258 0.0271 ...
### $ tBodyAcc-arCoeff()-Z,3              : num  -0.1715 0.0353 0.6321 0.4164 -0.1459 ...
### $ tBodyAcc-arCoeff()-Z,4              : num  0.0401 -0.0101 -0.5507 -0.2864 -0.0502 ...
### $ tBodyAcc-correlation()-X,Y          : num  0.077 -0.105 0.3057 -0.0638 0.2352 ...
### $ tBodyAcc-correlation()-X,Z          : num  -0.491 -0.429 -0.324 -0.167 0.29 ...
### $ tBodyAcc-correlation()-Y,Z          : num  -0.709 0.399 0.28 0.545 0.458 ...
### $ tGravityAcc-mean()-X                : num  0.936 0.927 0.93 0.929 0.927 ...
### $ tGravityAcc-mean()-Y                : num  -0.283 -0.289 -0.288 -0.293 -0.303 ...
### $ tGravityAcc-mean()-Z                : num  0.115 0.153 0.146 0.143 0.138 ...
### $ tGravityAcc-std()-X                 : num  -0.925 -0.989 -0.996 -0.993 -0.996 ...
### $ tGravityAcc-std()-Y                 : num  -0.937 -0.984 -0.988 -0.97 -0.971 ...
### $ tGravityAcc-std()-Z                 : num  -0.564 -0.965 -0.982 -0.992 -0.968 ...
### $ tGravityAcc-mad()-X                 : num  -0.93 -0.989 -0.996 -0.993 -0.996 ...
### $ tGravityAcc-mad()-Y                 : num  -0.938 -0.983 -0.989 -0.971 -0.971 ...
### $ tGravityAcc-mad()-Z                 : num  -0.606 -0.965 -0.98 -0.993 -0.969 ...
### $ tGravityAcc-max()-X                 : num  0.906 0.856 0.856 0.856 0.854 ...
### $ tGravityAcc-max()-Y                 : num  -0.279 -0.305 -0.305 -0.305 -0.313 ...
### $ tGravityAcc-max()-Z                 : num  0.153 0.153 0.139 0.136 0.134 ...
### $ tGravityAcc-min()-X                 : num  0.944 0.944 0.949 0.947 0.946 ...
### $ tGravityAcc-min()-Y                 : num  -0.262 -0.262 -0.262 -0.273 -0.279 ...
### $ tGravityAcc-min()-Z                 : num  -0.0762 0.149 0.145 0.1421 0.1309 ...
### $ tGravityAcc-sma()                   : num  -0.0178 0.0577 0.0406 0.0461 0.0554 ...
### $ tGravityAcc-energy()-X              : num  0.829 0.806 0.812 0.809 0.804 ...
### $ tGravityAcc-energy()-Y              : num  -0.865 -0.858 -0.86 -0.854 -0.843 ...
### $ tGravityAcc-energy()-Z              : num  -0.968 -0.957 -0.961 -0.963 -0.965 ...
### $ tGravityAcc-iqr()-X                 : num  -0.95 -0.988 -0.996 -0.992 -0.996 ...
### $ tGravityAcc-iqr()-Y                 : num  -0.946 -0.982 -0.99 -0.973 -0.972 ...
### $ tGravityAcc-iqr()-Z                 : num  -0.76 -0.971 -0.979 -0.996 -0.969 ...
### $ tGravityAcc-entropy()-X             : num  -0.425 -0.729 -0.823 -0.823 -0.83 ...
### $ tGravityAcc-entropy()-Y             : num  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...
### $ tGravityAcc-entropy()-Z             : num  0.219 -0.465 -0.53 -0.7 -0.302 ...
### $ tGravityAcc-arCoeff()-X,1           : num  -0.43 -0.51 -0.295 -0.343 -0.482 ...
### $ tGravityAcc-arCoeff()-X,2           : num  0.431 0.525 0.305 0.359 0.539 ...
### $ tGravityAcc-arCoeff()-X,3           : num  -0.432 -0.54 -0.315 -0.375 -0.596 ...
### $ tGravityAcc-arCoeff()-X,4           : num  0.433 0.554 0.326 0.392 0.655 ...
### $ tGravityAcc-arCoeff()-Y,1           : num  -0.795 -0.746 -0.232 -0.233 -0.493 ...
### $ tGravityAcc-arCoeff()-Y,2           : num  0.781 0.733 0.169 0.176 0.463 ...
### $ tGravityAcc-arCoeff()-Y,3           : num  -0.78 -0.737 -0.155 -0.169 -0.465 ...
### $ tGravityAcc-arCoeff()-Z,1           : num  -0.984 -0.845 -0.429 -0.297 -0.536 ...
### $ tGravityAcc-arCoeff()-Z,2           : num  0.987 0.869 0.44 0.304 0.544 ...
### $ tGravityAcc-arCoeff()-Z,3           : num  -0.989 -0.893 -0.451 -0.311 -0.553 ...
### $ tGravityAcc-arCoeff()-Z,4           : num  0.988 0.913 0.458 0.315 0.559 ...
### $ tGravityAcc-correlation()-X,Y       : num  0.981 0.945 0.548 0.986 0.998 ...
### $ tGravityAcc-correlation()-X,Z       : num  -0.996 -0.911 -0.335 0.653 0.916 ...
### $ tGravityAcc-correlation()-Y,Z       : num  -0.96 -0.739 0.59 0.747 0.929 ...
### $ tBodyAccJerk-mean()-X               : num  0.072 0.0702 0.0694 0.0749 0.0784 ...
### $ tBodyAccJerk-mean()-Y               : num  0.04575 -0.01788 -0.00491 0.03227 0.02228 ...
### $ tBodyAccJerk-mean()-Z               : num  -0.10604 -0.00172 -0.01367 0.01214 0.00275 ...
### $ tBodyAccJerk-std()-X                : num  -0.907 -0.949 -0.991 -0.991 -0.992 ...
### $ tBodyAccJerk-std()-Y                : num  -0.938 -0.973 -0.971 -0.973 -0.979 ...
### $ tBodyAccJerk-std()-Z                : num  -0.936 -0.978 -0.973 -0.976 -0.987 ...
### $ tBodyAccJerk-mad()-X                : num  -0.916 -0.969 -0.991 -0.99 -0.991 ...
### $ tBodyAccJerk-mad()-Y                : num  -0.937 -0.974 -0.973 -0.973 -0.977 ...
### $ tBodyAccJerk-mad()-Z                : num  -0.949 -0.979 -0.975 -0.978 -0.985 ...
### $ tBodyAccJerk-max()-X                : num  -0.903 -0.915 -0.992 -0.992 -0.994 ...
### $ tBodyAccJerk-max()-Y                : num  -0.95 -0.981 -0.975 -0.975 -0.986 ...
### $ tBodyAccJerk-max()-Z                : num  -0.891 -0.978 -0.962 -0.962 -0.986 ...
### $ tBodyAccJerk-min()-X                : num  0.898 0.898 0.994 0.994 0.994 ...
### $ tBodyAccJerk-min()-Y                : num  0.95 0.968 0.976 0.976 0.98 ...
### $ tBodyAccJerk-min()-Z                : num  0.946 0.966 0.966 0.97 0.985 ...
### $ tBodyAccJerk-sma()                  : num  -0.931 -0.974 -0.982 -0.983 -0.987 ...
### $ tBodyAccJerk-energy()-X             : num  -0.995 -0.998 -1 -1 -1 ...
### $ tBodyAccJerk-energy()-Y             : num  -0.997 -0.999 -0.999 -0.999 -1 ...
### $ tBodyAccJerk-energy()-Z             : num  -0.997 -0.999 -0.999 -0.999 -1 ...
###  [list output truncated]

## Take only the measurements on the mean and standard deviation for each measurement using grep() function and assign it to a variable named FeaturesData2
FeaturesData2<-readFeaturesData$V2[grep("mean\\(\\)|std\\(\\)", readFeaturesData$V2)]

##Generate a string representation of FeaturesData2 and assign it to a variable named FeatData2Char
FeatData2Char<-c(as.character(FeaturesData2), "Subject", "Activity" )

##Extract FeatData2Char from MergedData and assign it to Merged Data
MergedData<-subset(MergedData,select=FeatData2Char)
##Check the property of MergedData using str() function
str(MergedData)
### 'data.frame':	10299 obs. of  68 variables:
### $ tBodyAcc-mean()-X          : num  0.257 0.286 0.275 0.27 0.275 ...
### $ tBodyAcc-mean()-Y          : num  -0.0233 -0.0132 -0.0261 -0.0326 -0.0278 ...
### $ tBodyAcc-mean()-Z          : num  -0.0147 -0.1191 -0.1182 -0.1175 -0.1295 ...
### $ tBodyAcc-std()-X           : num  -0.938 -0.975 -0.994 -0.995 -0.994 ...
### $ tBodyAcc-std()-Y           : num  -0.92 -0.967 -0.97 -0.973 -0.967 ...
### $ tBodyAcc-std()-Z           : num  -0.668 -0.945 -0.963 -0.967 -0.978 ...
### $ tGravityAcc-mean()-X       : num  0.936 0.927 0.93 0.929 0.927 ...
### $ tGravityAcc-mean()-Y       : num  -0.283 -0.289 -0.288 -0.293 -0.303 ...
### $ tGravityAcc-mean()-Z       : num  0.115 0.153 0.146 0.143 0.138 ...
### $ tGravityAcc-std()-X        : num  -0.925 -0.989 -0.996 -0.993 -0.996 ...
### $ tGravityAcc-std()-Y        : num  -0.937 -0.984 -0.988 -0.97 -0.971 ...
### $ tGravityAcc-std()-Z        : num  -0.564 -0.965 -0.982 -0.992 -0.968 ...
### $ tBodyAccJerk-mean()-X      : num  0.072 0.0702 0.0694 0.0749 0.0784 ...
### $ tBodyAccJerk-mean()-Y      : num  0.04575 -0.01788 -0.00491 0.03227 0.02228 ...
### $ tBodyAccJerk-mean()-Z      : num  -0.10604 -0.00172 -0.01367 0.01214 0.00275 ...
### $ tBodyAccJerk-std()-X       : num  -0.907 -0.949 -0.991 -0.991 -0.992 ...
### $ tBodyAccJerk-std()-Y       : num  -0.938 -0.973 -0.971 -0.973 -0.979 ...
### $ tBodyAccJerk-std()-Z       : num  -0.936 -0.978 -0.973 -0.976 -0.987 ...
### $ tBodyGyro-mean()-X         : num  0.11998 -0.00155 -0.04821 -0.05664 -0.05999 ...
### $ tBodyGyro-mean()-Y         : num  -0.0918 -0.1873 -0.1663 -0.126 -0.0847 ...
### $ tBodyGyro-mean()-Z         : num  0.1896 0.1807 0.1542 0.1183 0.0787 ...
### $ tBodyGyro-std()-X          : num  -0.883 -0.926 -0.973 -0.968 -0.975 ...
### $ tBodyGyro-std()-Y          : num  -0.816 -0.93 -0.979 -0.975 -0.978 ...
### $ tBodyGyro-std()-Z          : num  -0.941 -0.968 -0.976 -0.963 -0.968 ...
### $ tBodyGyroJerk-mean()-X     : num  -0.2049 -0.1387 -0.0978 -0.1022 -0.0918 ...
### $ tBodyGyroJerk-mean()-Y     : num  -0.1745 -0.0258 -0.0342 -0.0447 -0.029 ...
### $ tBodyGyroJerk-mean()-Z     : num  -0.0934 -0.0714 -0.06 -0.0534 -0.0612 ...
### $ tBodyGyroJerk-std()-X      : num  -0.901 -0.962 -0.984 -0.984 -0.988 ...
### $ tBodyGyroJerk-std()-Y      : num  -0.911 -0.956 -0.988 -0.99 -0.992 ...
### $ tBodyGyroJerk-std()-Z      : num  -0.939 -0.981 -0.976 -0.981 -0.982 ...
### $ tBodyAccMag-mean()         : num  -0.867 -0.969 -0.976 -0.974 -0.976 ...
### $ tBodyAccMag-std()          : num  -0.705 -0.954 -0.979 -0.977 -0.977 ...
### $ tGravityAccMag-mean()      : num  -0.867 -0.969 -0.976 -0.974 -0.976 ...
### $ tGravityAccMag-std()       : num  -0.705 -0.954 -0.979 -0.977 -0.977 ...
### $ tBodyAccJerkMag-mean()     : num  -0.93 -0.974 -0.982 -0.983 -0.987 ...
### $ tBodyAccJerkMag-std()      : num  -0.896 -0.941 -0.971 -0.975 -0.989 ...
### $ tBodyGyroMag-mean()        : num  -0.796 -0.898 -0.939 -0.947 -0.957 ...
### $ tBodyGyroMag-std()         : num  -0.762 -0.911 -0.972 -0.97 -0.969 ...
### $ tBodyGyroJerkMag-mean()    : num  -0.925 -0.973 -0.987 -0.989 -0.99 ...
### $ tBodyGyroJerkMag-std()     : num  -0.894 -0.944 -0.984 -0.986 -0.99 ...
### $ fBodyAcc-mean()-X          : num  -0.919 -0.961 -0.992 -0.993 -0.992 ...
### $ fBodyAcc-mean()-Y          : num  -0.918 -0.964 -0.965 -0.968 -0.969 ...
### $ fBodyAcc-mean()-Z          : num  -0.789 -0.957 -0.967 -0.967 -0.98 ...
### $ fBodyAcc-std()-X           : num  -0.948 -0.984 -0.995 -0.996 -0.995 ...
### $ fBodyAcc-std()-Y           : num  -0.925 -0.97 -0.974 -0.977 -0.967 ...
### $ fBodyAcc-std()-Z           : num  -0.636 -0.942 -0.962 -0.969 -0.978 ...
### $ fBodyAccJerk-mean()-X      : num  -0.9 -0.944 -0.991 -0.991 -0.991 ...
### $ fBodyAccJerk-mean()-Y      : num  -0.937 -0.969 -0.973 -0.972 -0.98 ...
### $ fBodyAccJerk-mean()-Z      : num  -0.924 -0.973 -0.972 -0.97 -0.983 ...
### $ fBodyAccJerk-std()-X       : num  -0.924 -0.962 -0.992 -0.992 -0.994 ...
### $ fBodyAccJerk-std()-Y       : num  -0.943 -0.98 -0.971 -0.975 -0.979 ...
### $ fBodyAccJerk-std()-Z       : num  -0.948 -0.981 -0.972 -0.981 -0.989 ...
### $ fBodyGyro-mean()-X         : num  -0.824 -0.923 -0.973 -0.972 -0.976 ...
### $ fBodyGyro-mean()-Y         : num  -0.808 -0.926 -0.981 -0.981 -0.98 ...
### $ fBodyGyro-mean()-Z         : num  -0.918 -0.968 -0.972 -0.967 -0.969 ...
### $ fBodyGyro-std()-X          : num  -0.903 -0.927 -0.973 -0.967 -0.974 ...
### $ fBodyGyro-std()-Y          : num  -0.823 -0.932 -0.977 -0.972 -0.977 ...
### $ fBodyGyro-std()-Z          : num  -0.956 -0.97 -0.979 -0.965 -0.97 ...
### $ fBodyAccMag-mean()         : num  -0.791 -0.954 -0.976 -0.973 -0.978 ...
### $ fBodyAccMag-std()          : num  -0.711 -0.96 -0.984 -0.982 -0.979 ...
### $ fBodyBodyAccJerkMag-mean() : num  -0.895 -0.945 -0.971 -0.972 -0.987 ...
### $ fBodyBodyAccJerkMag-std()  : num  -0.896 -0.934 -0.97 -0.978 -0.99 ...
### $ fBodyBodyGyroMag-mean()    : num  -0.771 -0.924 -0.975 -0.976 -0.977 ...
### $ fBodyBodyGyroMag-std()     : num  -0.797 -0.917 -0.974 -0.971 -0.97 ...
### $ fBodyBodyGyroJerkMag-mean(): num  -0.89 -0.952 -0.986 -0.986 -0.99 ...
### $ fBodyBodyGyroJerkMag-std() : num  -0.907 -0.938 -0.983 -0.986 -0.991 ...
### $ Subject                    : int  2 2 2 2 2 2 2 2 2 2 ...
### $ Activity                   : int  5 5 5 5 5 5 5 5 5 5 ...

##Uses descriptive activity names to name the activities in the dataset

##Read the text file "activity_labels" from "UCI HAR Dataset" folder using read.table() and assign it to a variable named ActivityDesc.
ActivityDesc <- read.table(file.path(getwd(), "activity_labels.txt"),header = FALSE)

##Generate a character representation of a subset MergedData$Activity from ActivityDesc
MergedData$Activity <- as.character(MergedData$Activity)
for (i in 1:6){
       MergedData$Activity[MergedData$Activity == i] <- as.character(ActivityDesc[i,2])
   }
   
##Convert MergedData$activity from numeric to factor using as.factor() function
MergedData$Activity <- as.factor(MergedData$activity)

##Check to see that the activities were named in the data set using activity labels.
head(MergedData$activity,30)
### [1] STANDING STANDING STANDING STANDING STANDING STANDING STANDING STANDING STANDING STANDING STANDING ### [12]STANDING STANDING STANDING STANDING STANDING STANDING STANDING STANDING STANDING STANDING STANDING ### [23]STANDING STANDING STANDING STANDING STANDING STANDING STANDING STANDING
### Levels: LAYING SITTING STANDING WALKING WALKING_DOWNSTAIRS WALKING_UPSTAIRS

##Appropriately labels the data set with descriptive variable names
# t is label by time
#Acc is replaced by Accelerometer
#Gyro is replaced by Gyroscope
#prefix f is replaced by frequency
#Mag is replaced by Magnitude
#BodyBody is replaced by Body
names(MergedData)<-gsub("^t", "time", names(MergedData))
names(MergedData)<-gsub("^f", "frequency", names(MergedData))
names(MergedData)<-gsub("Acc", "Accelerometer", names(MergedData))
names(MergedData)<-gsub("Gyro", "Gyroscope", names(MergedData))
names(MergedData)<-gsub("Mag", "Magnitude", names(MergedData))
names(MergedData)<-gsub("BodyBody", "Body", names(MergedData)) 
##Check the labeled data set in Mergeddata with descriptive variable names.
names(MergedData)
### [1] "timeBodyAccelerometer-mean()-X"                 "timeBodyAccelerometer-mean()-Y"                
### [3] "timeBodyAccelerometer-mean()-Z"                 "timeBodyAccelerometer-std()-X"                 
### [5] "timeBodyAccelerometer-std()-Y"                  "timeBodyAccelerometer-std()-Z"                 
### [7] "timeGravityAccelerometer-mean()-X"              "timeGravityAccelerometer-mean()-Y"             
### [9] "timeGravityAccelerometer-mean()-Z"              "timeGravityAccelerometer-std()-X"              
###[11] "timeGravityAccelerometer-std()-Y"               "timeGravityAccelerometer-std()-Z"              
###[13] "timeBodyAccelerometerJerk-mean()-X"             "timeBodyAccelerometerJerk-mean()-Y"            
###[15] "timeBodyAccelerometerJerk-mean()-Z"             "timeBodyAccelerometerJerk-std()-X"             
###[17] "timeBodyAccelerometerJerk-std()-Y"              "timeBodyAccelerometerJerk-std()-Z"             
###[19] "timeBodyGyroscope-mean()-X"                     "timeBodyGyroscope-mean()-Y"                    
###[21] "timeBodyGyroscope-mean()-Z"                     "timeBodyGyroscope-std()-X"                     
###[23] "timeBodyGyroscope-std()-Y"                      "timeBodyGyroscope-std()-Z"                     
###[25] "timeBodyGyroscopeJerk-mean()-X"                 "timeBodyGyroscopeJerk-mean()-Y"                
###[27] "timeBodyGyroscopeJerk-mean()-Z"                 "timeBodyGyroscopeJerk-std()-X"                 
###[29] "timeBodyGyroscopeJerk-std()-Y"                  "timeBodyGyroscopeJerk-std()-Z"                 
###[31] "timeBodyAccelerometerMagnitude-mean()"          "timeBodyAccelerometerMagnitude-std()"          
###[33] "timeGravityAccelerometerMagnitude-mean()"       "timeGravityAccelerometerMagnitude-std()"       
###[35] "timeBodyAccelerometerJerkMagnitude-mean()"      "timeBodyAccelerometerJerkMagnitude-std()"      
###[37] "timeBodyGyroscopeMagnitude-mean()"              "timeBodyGyroscopeMagnitude-std()"              
###[39] "timeBodyGyroscopeJerkMagnitude-mean()"          "timeBodyGyroscopeJerkMagnitude-std()"          
###[41] "frequencyBodyAccelerometer-mean()-X"            "frequencyBodyAccelerometer-mean()-Y"           
###[43] "frequencyBodyAccelerometer-mean()-Z"            "frequencyBodyAccelerometer-std()-X"            
###[45] "frequencyBodyAccelerometer-std()-Y"             "frequencyBodyAccelerometer-std()-Z"            
###[47] "frequencyBodyAccelerometerJerk-mean()-X"        "frequencyBodyAccelerometerJerk-mean()-Y"       
###[49] "frequencyBodyAccelerometerJerk-mean()-Z"        "frequencyBodyAccelerometerJerk-std()-X"        
###[51] "frequencyBodyAccelerometerJerk-std()-Y"         "frequencyBodyAccelerometerJerk-std()-Z"        
###[53] "frequencyBodyGyroscope-mean()-X"                "frequencyBodyGyroscope-mean()-Y"               
###[55] "frequencyBodyGyroscope-mean()-Z"                "frequencyBodyGyroscope-std()-X"                
###[57] "frequencyBodyGyroscope-std()-Y"                 "frequencyBodyGyroscope-std()-Z"                
###[59] "frequencyBodyAccelerometerMagnitude-mean()"     "frequencyBodyAccelerometerMagnitude-std()"     
###[61] "frequencyBodyAccelerometerJerkMagnitude-mean()" "frequencyBodyAccelerometerJerkMagnitude-std()" 
###[63] "frequencyBodyGyroscopeMagnitude-mean()"         "frequencyBodyGyroscopeMagnitude-std()"         
###[65] "frequencyBodyGyroscopeJerkMagnitude-mean()"     "frequencyBodyGyroscopeJerkMagnitude-std()"     
###[67] "Subject"                                        "Activity"     


#From the data set in step 4, create a second, independent tidy data set with the average of each variable on each activity and each subject

##Install and load "plyr" for easier extracting, manipulating, and merging data
install.packages("plyr")
library(plyr)

##Extract a subset from MergedData that computes the average of each variable on each activity and each subject and returns the result in a IndData
IndData<-aggregate(. ~Subject + Activity, MergedData, mean)

##Sorting data in a new created data set named IndData using order() function
IndData<-IndData[order(IndData$Subject,IndData$Activity),]

##Print IndData to a text file named tidy data using write.table() function
write.table(IndData, file = "tidydata.txt",row.name=FALSE)

